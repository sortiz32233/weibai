$(function(){"use strict";var e=$("<button/>").addClass("btn btn-primary").prop("disabled",!0).prop("type","button").text("Processing...").on("click",function(){var e=$(this),n=e.data();e.off("click").text("Abort").on("click",function(){e.remove(),n.abort()}),n.submit().always(function(){e.remove()})});$(".Jupload").fileupload({url:"/upload/index?action=pdimage&json=1",dataType:"json",autoUpload:!1,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,maxNumberOfFiles:1,maxFileSize:999e3,disableImageResize:/Android(?!.*Chrome)|Opera/.test(window.navigator.userAgent),previewMaxWidth:100,previewMaxHeight:100,previewCrop:!0}).on("fileuploadadd",function(n,t){var a=$(t.fileInputClone[0]).data("show");t.context=$("<div/>").appendTo($(a)),$.each(t.files,function(n,a){var i=$("<p/>").append($("<span/>").text(a.name));n||i.append(e.clone(!0).data(t)),i.appendTo(t.context)})}).on("fileuploadprocessalways",function(e,n){var t=n.index,a=n.files[t],i=$(n.context.children()[t]);a.preview&&i.prepend("<br>").prepend(a.preview),a.error&&i.append("<br>").append($('<span class="text-danger"/>').text(a.error)),t+1===n.files.length&&n.context.find("button").text("上传").prop("disabled",!!n.files.error)}).on("fileuploaddone",function(e,n){if("success"===n.result.status){var t=$("<i/>").addClass("btn-close").text("x").on("click",function(){$(this).parent().parent().remove()}),a="<img src='"+n.result.minUrl+"'><input type='hidden' name='imgUrl[]' value='"+n.result.bgUrl+"'>";$(n.context.children()).append(a),$(n.context.children()).append(t),$(n.context).find("span").remove()}}).on("fileuploadfail",function(e,n){$.each(n.files,function(e){var t=$('<span class="text-danger"/>').text("File upload failed.");$(n.context.children()[e]).append("<br>").append(t)})}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?void 0:"disabled")});