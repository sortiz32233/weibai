var News={wangEditor:null,init:function(){this.bind(),this.intWangEditor(),$("#newsForm").hide()},intWangEditor:function(){var t=this;t.wangEditor=new wangEditor("editor-trigger"),t.wangEditor.config.uploadImgUrl="/upload/index?action=edimage",t.wangEditor.config.uploadImgFileName="upfile",t.wangEditor.create()},bind:function(){var t=this;$(document).on("click","#editCms",function(){t.showEditForm($(this).data("id"))}).on("click","#cancelEdit",function(){$("#newsForm").hide()}).on("click","#saveEdit",function(){t.saveEditFormData()}).on("click","#deleteCms",function(){var n=$(this);Modal.confirm({id:"Jmodal",content:"确定要删除该条记录？",callback:function(){App.blockUI($("#Jmodal")),t.deleteOne(n.data("id"))}})}).on("click","#addNews",function(){t.showAddForm()})},postData:function(t){try{$.ajax({url:t.url||"",data:t.data,type:t.type||"get",dataType:"json",beforeSend:function(){},success:function(n){null!=t.callback&&t.callback(n)},error:function(t){},complete:function(t){}})}catch(t){console.error(t)}},showEditForm:function(t){var n=News,o={cmsId:t},a={url:"/cms/GetOneById",data:o,callback:n.setEditFormData};n.postData(a)},setEditFormData:function(t){var n=News;null!=t&&($("#cmsId").val(t.id),$("#cmsTitle").val(t.title),$("#cmsDes").val(t.des),$("#cmsUrl").val(t.hyperlink),n.wangEditor.$txt.html(t.content),$("#newsForm").show())},saveEditFormData:function(){var t=this,n=$("#cmsId").val(),o=News.wangEditor.$txt.html(),a="/cms/add?content="+o;n>0&&(a="/cms/update?content="+o),t.postData({url:a,data:$("#Jnewform").serialize(),type:"post",callback:function(t){"success"==t.status?Modal.alert({id:"Jalert",content:"新闻添加成功！",type:"success",callback:function(){window.location.reload()}}):Modal.alert({id:"Jalert",type:"error",content:"新闻添加失败，请稍后重试！"})}})},deleteOne:function(t){this.postData({url:"/cms/delete",data:{cmsId:t,json:1},callback:function(t){App.unblockUI($("#Jmodal")),"success"==t.status?Modal.alert({id:"Jalert",content:"删除成功！",type:"success",callback:function(){window.location.reload()}}):Modal.alert({id:"Jalert",type:"error",content:"删除失败，请稍后重试！"})}})},showAddForm:function(){$("#newsForm").show(),$(":input","#newsForm").not(":button, :submit, :reset, :hidden").val("").removeAttr("checked").removeAttr("selected"),this.wangEditor.$txt.html("<p><br></p>")}};$(function(){News.init()});